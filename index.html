Great 👍 Let’s start with the frontend (JS) part for the Block/Unblock user feature.

Below is the jQuery code you can add inside your existing superAdmin.js file (right after the renderUsersTable() function).


---

✅ Frontend Code (jQuery + SweetAlert)

function toggleUserStatus(userId, currentStatus) {
    let newStatus = currentStatus === "Active" ? "Blocked" : "Active";
    let confirmMsg = currentStatus === "Active"
        ? "Are you sure you want to block this user?"
        : "Are you sure you want to unblock this user?";

    Swal.fire({
        title: "Confirm Action",
        text: confirmMsg,
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes, proceed"
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: "http://localhost:8080/BiteBudddy/AdminDashboardServlet",
                method: "POST",
                data: {
                    action: "toggleUserStatus",
                    userId: userId,
                    currentStatus: currentStatus
                },
                success: function(response) {
                    if (response.success) {
                        Swal.fire("Success!", response.message, "success");
                        setTimeout(() => loadUsers(), 1000);
                    } else {
                        Swal.fire("Error", response.message || "Something went wrong", "error");
                    }
                },
                error: function() {
                    Swal.fire("Error", "Failed to update user status.", "error");
                }
            });
        }
    });
}


---

🧠 What Happens Here

1. When admin clicks the Block/Unblock button,
this function is triggered with userId and currentStatus.


2. A SweetAlert confirmation box appears.


3. On confirmation → an AJAX POST request is sent to servlet.


4. Servlet updates DB (we’ll handle next).


5. On success → SweetAlert “Success!” + table refresh.




---

Would you like me to proceed with the Servlet (AdminDashboardServlet) implementation next?

Perfect 👌 — here’s the Servlet part for the Block/Unblock user action in your existing
AdminDashboardServlet.java.

You’ll place this inside your main doPost() method (since the frontend sends a POST request).


---

✅ AdminDashboardServlet.java (POST handling)

@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
    response.setContentType("application/json");
    PrintWriter out = response.getWriter();
    Gson gson = new Gson();

    String action = request.getParameter("action");
    Map<String, Object> jsonResponse = new HashMap<>();

    try {
        if ("toggleUserStatus".equals(action)) {
            int userId = Integer.parseInt(request.getParameter("userId"));
            String currentStatus = request.getParameter("currentStatus");

            boolean updated = adminService.toggleUserStatus(userId, currentStatus);

            if (updated) {
                jsonResponse.put("success", true);
                jsonResponse.put("message", currentStatus.equals("Active")
                        ? "User has been blocked successfully."
                        : "User has been unblocked successfully.");
            } else {
                jsonResponse.put("success", false);
                jsonResponse.put("message", "Failed to update user status.");
            }
        }

    } catch (Exception e) {
        e.printStackTrace();
        jsonResponse.put("success", false);
        jsonResponse.put("message", "An error occurred: " + e.getMessage());
    }

    out.print(gson.toJson(jsonResponse));
    out.flush();
}


---

✅ AdminService.java

Add this function:

public boolean toggleUserStatus(int userId, String currentStatus) {
    String newStatus = currentStatus.equals("Active") ? "Blocked" : "Active";
    return adminDao.updateUserStatus(userId, newStatus);
}


---

✅ AdminDao.java

Add the actual DB update logic:

public boolean updateUserStatus(int userId, String newStatus) {
    String query = "UPDATE users SET status = ? WHERE user_id = ?";
    try (Connection conn = DBConnection.getConnection();
         PreparedStatement ps = conn.prepareStatement(query)) {
        ps.setString(1, newStatus);
        ps.setInt(2, userId);
        return ps.executeUpdate() > 0;
    } catch (SQLException e) {
        e.printStackTrace();
        return false;
    }
}


---

✅ SQL Table Reference

Make sure your users table contains a column:

status VARCHAR(10) DEFAULT 'Active'


---

🧠 Flow Summary

1. Admin clicks Block/Unblock → AJAX sends userId + currentStatus.


2. Servlet → calls AdminService.toggleUserStatus().


3. Service → calls AdminDao.updateUserStatus().


4. DAO → updates DB, returns success/failure.


5. Servlet sends back JSON → SweetAlert shows success and reloads table.




---

Would you like to move next to Delete User functionality?
