Perfect — we’ll keep everything in your existing servlet fully untouched and only inject our unblock logic safely so that nothing existing breaks.

Let’s plan this correctly first 👇


---

⚙️ Plan for “Unblock User” Integration

We’ll:

1. ✅ Keep all your current logic as-is (no edits to existing if blocks).


2. 🧩 Add one new else if block at the bottom of doPost() for action="toggleUserStatus".


3. 🧠 Delegate all backend logic (DB update, etc.) to AdminService → AdminDao.


4. 📦 Return a JSON response { success: true, message: "User unblocked successfully" }.




---

✅ Safe Updated doPost() Section

(Only this addition — nothing else touched!)

@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {

    String action = request.getParameter("action");
    response.setContentType("application/json;charset=UTF-8");

    try (PrintWriter out = response.getWriter()) {

        if ("toggleRestaurantStatus".equals(action)) {
            int restaurantId = Integer.parseInt(request.getParameter("restaurantId"));
            String status = request.getParameter("status");
            boolean updated = adminService.toggleRestaurantStatus(restaurantId, status);
            out.write("{\"success\":" + updated + "}");

        } else if ("deleteRestaurant".equals(action)) {
            int restaurantId = Integer.parseInt(request.getParameter("restaurantId"));
            boolean deleted = adminService.deleteRestaurant(restaurantId);
            out.write("{\"success\":" + deleted + "}");

        } 
        // 🔥 NEW BLOCK: Safe addition — does not affect existing logic
        else if ("toggleUserStatus".equals(action)) {
            int userId = Integer.parseInt(request.getParameter("userId"));
            String status = request.getParameter("status"); // e.g., "Active" or "Blocked"

            boolean success = adminService.toggleUserStatus(userId, status);
            Map<String, Object> result = new HashMap<>();
            result.put("success", success);
            result.put("message", success
                    ? (status.equalsIgnoreCase("Active") ? "User blocked successfully" : "User unblocked successfully")
                    : "Failed to update user status");

            out.write(new Gson().toJson(result));
        }

    } catch (Exception e) {
        e.printStackTrace();
        response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
        response.getWriter().write("{\"error\":\"Server error occurred\"}");
    }
}


---

💾 No Other Changes Made

✅ No changes to existing actions
✅ No change to imports or response logic
✅ No impact on restaurant or dashboard endpoints


---

Would you like me to show the matching AdminService and AdminDao methods for this toggleUserStatus next (using your existing service–DAO pattern)?