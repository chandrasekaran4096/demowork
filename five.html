Perfect â€” weâ€™ll keep everything in your existing servlet fully untouched and only inject our unblock logic safely so that nothing existing breaks.

Letâ€™s plan this correctly first ğŸ‘‡


---

âš™ï¸ Plan for â€œUnblock Userâ€ Integration

Weâ€™ll:

1. âœ… Keep all your current logic as-is (no edits to existing if blocks).


2. ğŸ§© Add one new else if block at the bottom of doPost() for action="toggleUserStatus".


3. ğŸ§  Delegate all backend logic (DB update, etc.) to AdminService â†’ AdminDao.


4. ğŸ“¦ Return a JSON response { success: true, message: "User unblocked successfully" }.




---

âœ… Safe Updated doPost() Section

(Only this addition â€” nothing else touched!)

@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {

    String action = request.getParameter("action");
    response.setContentType("application/json;charset=UTF-8");

    try (PrintWriter out = response.getWriter()) {

        if ("toggleRestaurantStatus".equals(action)) {
            int restaurantId = Integer.parseInt(request.getParameter("restaurantId"));
            String status = request.getParameter("status");
            boolean updated = adminService.toggleRestaurantStatus(restaurantId, status);
            out.write("{\"success\":" + updated + "}");

        } else if ("deleteRestaurant".equals(action)) {
            int restaurantId = Integer.parseInt(request.getParameter("restaurantId"));
            boolean deleted = adminService.deleteRestaurant(restaurantId);
            out.write("{\"success\":" + deleted + "}");

        } 
        // ğŸ”¥ NEW BLOCK: Safe addition â€” does not affect existing logic
        else if ("toggleUserStatus".equals(action)) {
            int userId = Integer.parseInt(request.getParameter("userId"));
            String status = request.getParameter("status"); // e.g., "Active" or "Blocked"

            boolean success = adminService.toggleUserStatus(userId, status);
            Map<String, Object> result = new HashMap<>();
            result.put("success", success);
            result.put("message", success
                    ? (status.equalsIgnoreCase("Active") ? "User blocked successfully" : "User unblocked successfully")
                    : "Failed to update user status");

            out.write(new Gson().toJson(result));
        }

    } catch (Exception e) {
        e.printStackTrace();
        response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
        response.getWriter().write("{\"error\":\"Server error occurred\"}");
    }
}


---

ğŸ’¾ No Other Changes Made

âœ… No changes to existing actions
âœ… No change to imports or response logic
âœ… No impact on restaurant or dashboard endpoints


---

Would you like me to show the matching AdminService and AdminDao methods for this toggleUserStatus next (using your existing serviceâ€“DAO pattern)?